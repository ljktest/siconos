exec('SCI/scilab.star',-1);
exec('~/Scilab/LCP/LCP.sci',-1);


// Test matrix for LCP
// x >= 0, y> =0, x.y=0
// y=Ax+b

///////////////////////
M=[[2 1];[1 2]]
q=[-5 ; -6]
// Test on the  matrix M 
// for i=1:n
// if (det(M(1:i,1:i)) <=0) then
// printf('Warning : not a P-matrix\n')
// end
// end

[x,y]=LCP(M,q,'newton')
[x,y]=LCP(M,q,'qp')
[x,y]=LCP(M,q,'gnsl')


///////////////////////
M=[[1 -1 -1 -1];[-1 1 -1 -1 ];[1 1 2 0];[1 1 0 2]] 
q=[3 ;5 ; -9 ; -5]


[x,y]=LCP(M,q,'newton')
[x,y]=LCP(M,q,'qp')
[x,y]=LCP(M,q,'gnsl')


///////////////////////
M=[[1 0 2 -1];[0 1 1 4 ];[-2 -1 0 0 ];[1 -4 0 0 ]] 
q=[1/2 ; -1/2 ; 6 ;6 ]


[x,y]=LCP(M,q,'newton')
[x,y]=LCP(M,q,'qp')
[x,y]=LCP(M,q,'gnsl')

/////////////////////// four diodes bridges
M = [0.001  0.001  -1  0;
     0.001  0.001  0  -1;
     1  0  9.90099  -9.90099;
     0  1  -9.90099  9.90099]
q = [-0 ;-0; 9.90099; -9.90099]

[x,y]=LCP(M,q,'newton')
[x,y]=LCP(M,q,'qp')
[x,y]=LCP(M,q,'gnsl')



/////////////////////// 
M=[0.000278521 1.70539e-20 -0.000278521 -5.11618e-20 0 1;
1.70539e-20 0.000278521 1.70539e-20 -0.000278521 0 1;
-0.000278521 1.70539e-20 0.000278521 1.70539e-20 0 1;
-5.11618e-20 -0.000278521 1.70539e-20 0.000278521 -0 1;
0 0 0 -0 7.95775e-05 0;
-1 -1 -1 -1 0.4 0]

q=[-3.87598 ;-2.37328e-1; 3.87598; 7.11983e-16 ; -19.8165; 0]


/////////////////////// 
M1=[1.10524e-06 0            0            0            0           0;
    0           3.41277e-06  2.08965e-22 -3.41277e-06 -6.26895e-22 1;
    0           2.08965e-22  3.41277e-06  2.08965e-22 -3.41277e-06 1;
    0          -3.41277e-06  2.08965e-22  3.41277e-06  2.08965e-22 1;
    0          -6.26895e-22 -3.41277e-06  2.08965e-22  3.41277e-06 1;
    0.4        -1           -1           -1           -1           0]


Q1=[-25.3891; 0; 6; 7.34764e-16; -6; 0]
[x,y]=LCP(M1,Q1,'qp')